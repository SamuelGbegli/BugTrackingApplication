@page
@model BugTrackingApplication.Pages.Projects.IndexModel

@{
    ViewData["Title"] = "List of projects";
}

<h3>List of projects</h3>
<br />

@if (Model.Projects.Count > 0)
{
<form method="get" class="col-md-4">
        <label class="control-label">Sort by:</label>
        <select name="Sort" asp-for="Sort" class="form-control">
            <option>Last updated</option>
            <option>Date created</option>
            <option>Name</option>
            <option>Open bugs</option>
    </select>
        <label class="control-label">Order:</label>
        <select name="Order" asp-for="Order" class="form-control">
            <option>Descending</option>
        <option>Ascending</option>
    </select>
    <br />
        <label class="control-label">Only show projects with open bugs</label>
    <input type="checkbox" name="OpenBugsOnly" asp-for="OpenBugsOnly" />
    <br/>
    <input type="submit" class="btn btn-primary" value="Sort"/>
</form>

<hr/>

    <a asp-page="Create" class="btn btn-primary">Add new project</a>
<br />
    <table class="table">
        <thead>
            <tr>
                <th>
                    @Html.DisplayNameFor(model => model.Projects[0].Project.Name)
                </th>
                <th>
                   <span>Description</span>
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.Projects[0].Project.Created)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.Projects[0].Project.Updated)
                </th>
                <th>
                    Open bugs
                </th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model.Projects)
            {
                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.Project.Name)
                        @if(item.Project.Link is not null)
                        {
                            <br/>
                            <span>(<a href="@item.Project.Link">Link</a>)</span>
                        }
                    </td>
                    <td>
                        @if(item.Project.Description is not null)
                        {
                            @Html.DisplayFor(modelItem => item.Project.Description)
                        }
                        else
                        {
                            <span>n/a</span>
                        }
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Project.Created)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Project.Updated)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.BugCount)
                    </td>
                    <td>
                        <a asp-page="./Edit" asp-route-id="@item.Project.ID">Edit</a>
                        <br />
                        <a asp-page="../Bugs/Index" asp-route-id="@item.Project.ID">View bugs</a>
                        <br />
                        <a asp-page="./Delete" asp-route-id="@item.Project.ID">Delete</a>
                    </td>
                </tr>
            }
        </tbody>
    </table>

}
else{
    <div class="text-center">
    <h5>There are currently no projects. <a asp-page="./Create">Click here to add one.</a></h5>
    </div>
}